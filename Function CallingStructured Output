import OpenAI from "openai";

const client = new OpenAI({
  apiKey: process.env.AZURE_OPENAI_KEY,
  baseURL: "https://YOUR-RESOURCE.openai.azure.com/openai/deployments/YOUR-MODEL"
});

async function extractData(text: string) {
  const response = await client.chat.completions.create({
    model: "gpt-4o-mini",
    messages: [
      { role: "system", content: "Extract structured data." },
      { role: "user", content: text }
    ],
    functions: [
      {
        name: "invoice_info",
        parameters: {
          type: "object",
          properties: {
            company: { type: "string" },
            date: { type: "string" }
          },
          required: ["company", "date"]
        }
      }
    ],
    function_call: { name: "invoice_info" }
  });

  console.log(response.choices[0].message.function_call.arguments);
}

extractData("Invoice from Contoso on March 3, 2025");
